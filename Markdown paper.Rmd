---
title: "Populism Paper"
author: "Scott LaCombe"
date: "November 28, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup, include=FALSE}
#download dataset 

 if (!require(ghit)) install.packages("ghit")
   library(ghit)
   ghit::install_github("fsolt/icpsrdata")
   library(icpsrdata)
  data <- icpsr_download(file_id= 36390, email = getOption("icpsr_email"), password = getOption("icpsr_password"), reset = FALSE, download_dir = "icpsr_data", msg = TRUE, unzip = TRUE, delete_zip = TRUE)
  
#import dataset from file. Transfer from zip file to working directory
  
library(rio)
ANES <- import("anes_pilot_2016.sav")
```

```{r setup, include=FALSE}
# recoding commands 
library(car)
ANES$Male <- recode(ANES$gender, "2=0;1=1")
ANES$Male

# feeling thermometers
ANES$fttrump <- recode(ANES$fttrump, "998=NA")
ANES$ftsanders <- recode(ANES$ftsanders, "998=NA")
ANES$fthrc <- recode(ANES$fthrc, "998=NA")
ANES$ftrubio <- recode(ANES$ftrubio, "998=NA")

# age 
ANES$age<- 2016-ANES$birthyr

# White dummy 
ANES$white <- recode(ANES$race, "2:8=0; 1=1")

# Employment dummy
ANES$employed <-recode(ANES$employ, " 3:9=0; 1=1; 2=1")


#5 point ideology- Most conservative=5
ANES$Conservative <- recode(ANES$ideo5, "6=NA")


#7 point partisanship- Very Republican=7 
ANES$Republican <- recode(ANES$pid7, "8=NA")

#Religion- Protestant dummy
ANES$Protestant <- recode(ANES$religpew, "2:98=0; 1=1")

#Opportunity to get ahead- 5= great deal 
ANES$getahead <- recode(ANES$getahead, "8=NA")


#legal immigration impact 
ANES$immlegal <-recode(ANES$immig_legal, "1=7; 2=6; 3=5;4=4;5=3;6=2;7=1")


# Support for Campaign Finance Reform 
ANES$campfinance <-recode(ANES$campfin, "1=7; 2=6; 3=5;4=4;5=3;6=2;7=1")


# Free Trade
ANES$freetrade <-recode(ANES$freetrade, "1=7; 2=6; 3=5;4=4;5=3;6=2;7=1")


#Should Politicians Stick to Principles or Compromise 
ANES$principles <-recode(ANES$compromise, "1=0;2=1")


# American Identity 
ANES$americanid <-recode(ANES$amer_ident, "1=5; 2=4; 3=3; 4=2; 5=1")


# Perception of Income Gap
ANES$inequality <-recode(ANES$incgap20, "5=1; 4=2; 3=3;4=2; 5=1; 8=NA")


# Require Vaccines 
ANES$vaccine <-recode(ANES$vaccine, "1=7; 2=6; 3=5; 4=4; 5=3;6=2;7=1")


#Ability to Improve financial well-being
ANES$finwell <-recode(ANES$finwell, "1=7; 2=6; 3=5; 4=4; 5=3;6=2;7=1; 8=NA")


# Move up the income ladder- easier/harder
ANES$ladder <-recode(ANES$ladder, "1=7; 2=6; 3=5; 4=4; 5=3;6=2;7=1; 8=NA")


#political knowledge dummy- correct number of years for a senator
ANES$polknow<- recode(ANES$pk_sen, "1:5=0; 7:998=0; 6=1") 
 

#economic evaluations
ANES$econnow <- recode(ANES$econnow, "5=1; 4=2; 3=3; 2=4; 1=5")


#income 
ANES$income <- recode(ANES$faminc, "1=1; 2=2; 3=3; 4=4; 5=5; 6=6; 7=7; 8=8; 9=9; 10=10; 11=11; 12/31=12; 97/98=NA")




```


```{r}
#regression models for comparative understanding


compoptrump <- lm(fttrump~ freetrade+principles+ americanid+ age + Male + white + employed + Republican + Conservative + income+ educ, data=ANES, weights=weight)

compoprubio <- lm(ftrubio~ freetrade+principles+ americanid+ age + Male + white + employed + Republican + Conservative + income + educ, data=ANES, weights=weight)

compopsanders <-lm(ftsanders~ freetrade+principles+ americanid+ age + Male + white + employed + Republican + Conservative +income + educ, data=ANES, weights=weight)

compophrc <- lm(fthrc~ freetrade+principles+ americanid+ age + Male + white + employed + Republican + Conservative + income+ educ, data=ANES, weights=weight)
```


```{r}
#regression models for Huntington's Credd

huntpoptrump <- lm(fttrump~ campfinance+ percent16 + inequality + vaccine + finwell + age + Male + white + employed + Republican + Conservative + income, data=ANES, weights=weight)

huntpoprubio <- lm(ftrubio~ campfinance+ percent16 + inequality + vaccine + finwell + age + Male + white + employed + Republican + Conservative + income, data=ANES, weights=weight)

huntpopsanders<- lm(ftsanders~ campfinance+ percent16 + inequality + vaccine + finwell + age + Male + white + employed + Republican + Conservative + income, data=ANES, weights=weight)

huntpophrc <- lm(fthrc~ campfinance+ percent16 + inequality + vaccine + finwell + age + Male + white + employed + Republican + Conservative + income, data=ANES, weights=weight)
```


```{r}
hofpoptrump <- lm(fttrump~ econnow+ immlegal+ campfinance + age + Male + white + employed+ Republican + Conservative +income + educ, data=ANES, weights=weight)

hofpoprubio <- lm(ftrubio~ econnow+ immlegal+ campfinance+ age + Male + white + employed+ Republican + Conservative + income + educ, data=ANES, weights=weight)

hofpopsanders <- lm(ftsanders~ econnow+ immlegal+ campfinance+ age + Male + white + employed+ Republican + Conservative + income + educ, data=ANES, weights=weight)

hofpophrc <- lm(fthrc~ econnow+ immlegal+ campfinance+ age + Male + white + employed+ Republican + Conservative + income + educ, data=ANES, weights=weight)

```



```{r}
#diplaying models
install.packages("stargazer")
library(stargazer)

ComparativePopulist <- stargazer(compoptrump, compoprubio, compopsanders, compophrc, title="Comparative Populist Measures", single.row=TRUE,
ci=TRUE, ci.level=0.95, align=TRUE)


ComparativePopulism <- stargazer(compoptrump, compoprubio, compopsanders, compophrc, title="Comparative Populist Measures", single.row=TRUE,
ci=TRUE, ci.level=0.95, align=TRUE)

HuntingtonCreed <- stargazer(huntpoptrump, huntpoprubio, huntpopsanders, huntpophrc, title="Comparative Populist Measures", single.row=TRUE,
ci=TRUE, ci.level=0.95, align=TRUE)

HofstaderPopulism <- stargazer(hofpoptrump, hofpoprubio, hofpopsanders, hofpophrc, title="Comparative Populist Measures", single.row=TRUE,
ci=TRUE, ci.level=0.95, align=TRUE)


```

```{r setup, include=FALSE}
# create dot whisker plot 
install.packages("dotwhisker")
install.packages("broom")
install.packages("dplyr")

library(dotwhisker)
library(broom)
library(dplyr)

```

```{r}
dwplot(list(compoprubio, compoptrump, compopsanders, compophrc)) + relabel_y_axis(c("Free Trade", "No Compromise", "Americand Identity", "Age", "Male", "White", "Employed", "Republicanism", "Conservatism", "Income", "Education")) + xlab("Coefficient Estimate") + 
  geom_vline(xintercept=0)+ 
  ggtitle("Determinants of Candidate Approval") +
 xlab("Coefficient Estimate")+
    theme(plot.title = element_text(face="bold"),
          legend.justification=c(0, 0), legend.position=c(0, 1),
          legend.background = element_rect(colour="grey80"),
          legend.title.align = .5) +
    scale_colour_grey(start = .3, end = .7,
                      name = "Candidate",
                      breaks = c(0, 1, 2, 3),
                      labels = c("Rubio", "Trump", "Sanders", "Clinton"))
 

```


```{r}
dwplot(list(hofpoprubio, hofpoptrump, hofpopsanders, hofpophrc)) + relabel_y_axis(c("Current Economy", "Legal Immigration", "Campaign Finance Ref", "Age", "Male", "White", "Employed", "Republicanism", "Conservatism", "Income", "Education")) + xlab("Coefficient Estimate") + 
  geom_vline(xintercept=0)+ 
  ggtitle("Determinants of Candidate Approval") +
 xlab("Coefficient Estimate")+
    theme(plot.title = element_text(face="bold"),
          legend.justification=c(0, 0), legend.position=c(0, 1),
          legend.background = element_rect(colour="grey80"),
          legend.title.align = .5) +
    scale_colour_grey(start = .3, end = .7,
                      name = "Candidate",
                      breaks = c(0,1,2,3),
                      labels = c("Rubio", "Trump", "Sanders", "Clinton"))
```

```{r}
dwplot(list(huntpoprubio, huntpoptrump, huntpopsanders, huntpophrc)) + relabel_y_axis(c("Campaign Finance Ref", "Chance of Voting", "Inequality Perception", "Vaccine Requirement", "Age", "Male", "White", "Employed", "Republicanism", "Conservatism", "Income", "Education")) + xlab("Coefficient Estimate") + 
  geom_vline(xintercept=0)+ 
  ggtitle("Determinants of Candidate Approval") +
 xlab("Coefficient Estimate")+
    theme(plot.title = element_text(face="bold"),
          legend.justification=c(0, 0), legend.position=c(0, 1),
          legend.background = element_rect(colour="grey80"),
          legend.title.align = .5) +
    scale_colour_grey(start = .3, end = .7,
                      name = "Candidate",
                      breaks = c(0,1,2,3),
                      labels = c("Rubio", "Trump", "Sanders", "Clinton"))
```

